<!DOCTYPE html>

<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->

<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->

<!--[if !IE]><!-->
<html lang="en"> <!--<![endif]-->

<!-- BEGIN HEAD -->

<head>

    <meta charset="utf-8"/>

    <title>账户管理</title>

    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

    <meta content="" name="description"/>

    <meta content="" name="author"/>

    <!-- BEGIN GLOBAL MANDATORY STYLES -->

    <link href="media/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/style-metro.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/style.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/style-responsive.css" rel="stylesheet" type="text/css"/>

    <link href="media/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>

    <link href="media/css/uniform.default.css" rel="stylesheet" type="text/css"/>

    <!-- END GLOBAL MANDATORY STYLES -->

    <!-- BEGIN PAGE LEVEL STYLES -->

    <link rel="stylesheet" type="text/css" href="media/css/select2_metro.css"/>

    <link rel="stylesheet" href="media/css/DT_bootstrap.css"/>

    <!-- END PAGE LEVEL STYLES -->

    <link rel="shortcut icon" href="media/image/favicon.ico"/>
    <link href="bootstrapTable/bootstrap-table.css" rel="stylesheet"/>

</head>

<!-- END HEAD -->

<!-- BEGIN BODY -->

<body class="page-header-fixed">

<!-- BEGIN HEADER -->

<div class="header navbar navbar-inverse navbar-fixed-top">

    <!-- BEGIN TOP NAVIGATION BAR -->

    <div class="navbar-inner">

        <div class="container-fluid">
            <a class="brand" href="index.html">

                <img src="media/image/logo.png" alt="logo"/>

            </a>
            <a href="javascript:;" class="btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">

                <img src="media/image/menu-toggler.png" alt=""/>

            </a>
        </div>
    </div>
    <!-- END TOP NAVIGATION BAR -->

</div>

<!-- END HEADER -->

<!-- BEGIN CONTAINER -->

<div class="page-container row-fluid">

    <!-- BEGIN 导航栏 -->

    <div class="page-sidebar nav-collapse collapse">

        <!-- BEGIN SIDEBAR MENU -->

        <ul class="page-sidebar-menu">

            <li>

                <!-- BEGIN SIDEBAR TOGGLER BUTTON -->

                <div class="sidebar-toggler hidden-phone"></div>

                <!-- BEGIN SIDEBAR TOGGLER BUTTON -->

            </li>



            <li class="start ">

                <a href="index.html">

                    <i class="icon-home"></i>

                    <span class="title">首页</span>

                </a>

            </li>


            <!--客户管理 -->
            <li >
                <a href="javascript:;">
                    <i class="icon-th"></i>
                    <span class="title">客户管理</span>
                </a>
                <ul class="sub-menu">
                    <li >
                        <a href="userInfo_add.html">客户注册</a>
                    </li>
                    <li >
                        <a href="userInfo_managed.html">客户维护</a>
                    </li>
                </ul>
            </li>


            <!--账户管理 -->
            <li class="active ">
                <a href="javascript:;">
                    <i class="icon-th"></i>
                    <span class="title">账户管理</span>
                    <span class="selected"></span>
                    <span class="arrow open"></span>
                </a>
                <ul class="sub-menu">
                    <li  class="active">
                        <a href="account_managed.html">账户信息</a>
                    </li>
                    <li >
                        <a href="accountType_managed.html">账户类型</a>
                    </li>
                </ul>
            </li>

            <!--记账管理 -->
            <li >
                <a href="javascript:;">
                    <i class="icon-th"></i>
                    <span class="title">记账管理</span>
                </a>
                <ul class="sub-menu">
                    <li >
                        <a href="account_managed.html">充值流水信息</a>
                    </li>
                    <li >
                        <a href="accountType_managed.html">扣款流水信息</a>
                    </li>
                </ul>
            </li>

        </ul>

        <!-- END SIDEBAR MENU -->

    </div>

    <!-- END 导航栏 -->

    <!-- BEGIN PAGE -->

    <div class="page-content">

        <!-- BEGIN SAMPLE PORTLET CONFIGURATION MODAL FORM-->

        <div id="portlet-config" class="modal hide">

            <div class="modal-header">

                <button data-dismiss="modal" class="close" type="button"></button>

                <h3>portlet Settings</h3>

            </div>

            <div class="modal-body">

                <p>Here will be a configuration form</p>

            </div>

        </div>

        <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->

        <!-- BEGIN PAGE CONTAINER-->

        <div class="container-fluid">

            <!-- BEGIN PAGE HEADER-->

            <div class="row-fluid">

                <div class="span12">

                    <!-- BEGIN 主题配置 -->

                    <div class="color-panel hidden-phone">

                        <div class="color-mode-icons icon-color"></div>

                        <div class="color-mode-icons icon-color-close"></div>

                        <div class="color-mode">

                            <p>THEME COLOR</p>

                            <ul class="inline">

                                <li class="color-black current color-default" data-style="default"></li>

                                <li class="color-blue" data-style="blue"></li>

                                <li class="color-brown" data-style="brown"></li>

                                <li class="color-purple" data-style="purple"></li>

                                <li class="color-grey" data-style="grey"></li>

                                <li class="color-white color-light" data-style="light"></li>

                            </ul>

                            <label>

                                <span>Layout</span>

                                <select class="layout-option m-wrap small">

                                    <option value="fluid" selected="selected">Fluid</option>

                                    <option value="boxed">Boxed</option>

                                </select>

                            </label>

                            <label>

                                <span>Header</span>

                                <select class="header-option m-wrap small">

                                    <option value="fixed" selected="selected">Fixed</option>

                                    <option value="default">Default</option>

                                </select>

                            </label>

                            <label>

                                <span>Sidebar</span>

                                <select class="sidebar-option m-wrap small">

                                    <option value="fixed">Fixed</option>

                                    <option value="default" selected="selected">Default</option>

                                </select>

                            </label>

                            <label>

                                <span>Footer</span>

                                <select class="footer-option m-wrap small">

                                    <option value="fixed">Fixed</option>

                                    <option value="default" selected="selected">Default</option>

                                </select>

                            </label>

                        </div>

                    </div>

                    <!-- END 主题配置 -->

                    <!-- BEGIN PAGE TITLE & BREADCRUMB-->

                    <h3 class="page-title">

                        账户管理
                        <small>管理账户信息</small>

                    </h3>

                    <ul class="breadcrumb">

                        <li>

                            <i class="icon-home"></i>

                            <a href="index.html">主页</a>

                            <i class="icon-angle-right"></i>

                        </li>

                        <li>

                            <a href="#">账户信息管理</a>

                            <i class="icon-angle-right"></i>

                        </li>

                        <li><a href="#">账户信息</a></li>

                    </ul>

                    <!-- END PAGE TITLE & BREADCRUMB-->

                </div>

            </div>

            <!-- END PAGE HEADER-->

            <!-- BEGIN PAGE CONTENT-->


            <div class="row-fluid" style="width: 100%;height: 100%">

                <div class="span6 responsive" data-tablet="span12 fix-offset" data-desktop="span6"
                     style="width: 100%;height: 100%">

                    <!-- BEGIN EXAMPLE TABLE PORTLET-->
                    <!--  table_jun -->
                    <div class="portlet box grey">

                        <div class="container" style="margin-top:20px">
                            <div class="row">
                                <!-- 搜索框 -->
                                <div class="col-xs-6 pull-left">
                                    <div class="input-group">
                                        <input type="text" class=" form-control" name="phone" placeholder="请输入手机号"/>
                                                 <button class="btn blue btn btn-default search"
                                                         type="button">查询</button>
                                    </div>
                                </div>

                                <!-- 表格 -->
                                <div class="col-xs-12 container-fluid">
                                    <table id="table_user" class="table table-striped table-bordered table-hover"
                                           data-show-refresh="true"
                                           data-show-toggle="true"
                                           data-pagination="true"
                                           data-show-columns="true"
                                           data-height="700">

                                    </table>
                                </div>

                                <!-- 模态窗 -->
                                <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content animated bounceInRight">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"> &times; </button>
                                                <h4 class="modal-title" id="myModalLabel">修改客户信息</h4>
                                            </div>
                                            <div class="modal-body">
                                                <input name="id" id="id" type="hidden" value=""/>
                                                <div class="form-group"><label>姓名</label> <input name="name" id="save_name" type="text" class="form-control" /></div>
                                                <div class="form-group"><label>性别</label> <input name="sex" id="save_sex" type="text" class="form-control"/></div>
                                                <div class="form-group"><label>年龄</label> <input name="age" id="save_age" type="text" class="form-control"/></div>
                                                <div class="form-group"><label>手机</label> <input name="phone" id="save_phone" type="text" class="form-control"/></div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                                                <button type="button" id="save" class="btn btn-primary ">保存</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>


                    </div>

                    <!-- END EXAMPLE TABLE PORTLET-->

                </div>


            </div>

            <!-- END PAGE CONTENT-->

        </div>

        <!-- END PAGE CONTAINER-->

    </div>

    <!-- END PAGE -->

</div>


<!-- END CONTAINER -->

<!-- BEGIN FOOTER -->


<div class="footer">


    <div class="footer-tools">

			<span class="go-top">

			<i class="icon-angle-up"></i>

			</span>

    </div>

</div>


<!-- END FOOTER -->

<!-- BEGIN JAVASCRIPTS(Load javascripts at bottom, this will reduce page load time) -->

<!-- BEGIN CORE PLUGINS -->

<script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>

<script src="media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

<!-- IMPORTANT! Load jquery-ui-1.10.1.custom.min.js before bootstrap.min.js to fix bootstrap tooltip conflict with jquery ui tooltip -->

<script src="media/js/jquery-ui-1.10.1.custom.min.js" type="text/javascript"></script>

<script src="media/js/bootstrap.min.js" type="text/javascript"></script>

<!--[if lt IE 9]>

<script src="media/js/excanvas.min.js"></script>

<script src="media/js/respond.min.js"></script>

<![endif]-->

<script src="media/js/jquery.slimscroll.min.js" type="text/javascript"></script>

<script src="media/js/jquery.blockui.min.js" type="text/javascript"></script>

<script src="media/js/jquery.cookie.min.js" type="text/javascript"></script>

<script src="media/js/jquery.uniform.min.js" type="text/javascript"></script>

<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE LEVEL PLUGINS -->

<script type="text/javascript" src="media/js/select2.min.js"></script>

<script type="text/javascript" src="media/js/jquery.dataTables.js"></script>
<script type="text/javascript" src="bootstrapTable/bootstrap-table.js"></script>

<!--script type="text/javascript" src="bootstrapTable/bootstrap-table-locale-all.min.js"></script-->

<script type="text/javascript" src="media/js/DT_bootstrap.js"></script>
<script type="text/javascript" src="layer/layer.js"></script>

<!-- END PAGE LEVEL PLUGINS -->

<!-- BEGIN PAGE LEVEL SCRIPTS -->

<script src="media/js/app.js"></script>

<script src="media/js/table-managed.js"></script>

<script>

    jQuery(document).ready(function () {

        App.init();

        TableManaged.init();

    });

</script>
<script type="text/javascript">


    $(function () {

        //1.初始化Table
        var bstpTable = new BstpTable($("table"));
        bstpTable.inint({})

        //2.初始化Button的点击事件
        var oButtonInit = new ButtonInit(bstpTable);
        oButtonInit.Init(bstpTable);
    });


    class BstpTable {
        constructor(obj) {
            this.obj = obj;
        }

        inint(searchArgs) {
            //---先销毁表格 ---
            this.obj.bootstrapTable('destroy');
            //---初始化表格,动态从服务器加载数据---
            this.obj.bootstrapTable({
                //【发出请求的基础信息】
                url: '/Home/getAccount',
                method: 'post',
                contentType: "application/x-www-form-urlencoded",


                //【查询设置】
                /* queryParamsType的默认值为 'limit' ,在默认情况下 传给服务端的参数为：offset,limit,sort
                 设置为 ''  在这种情况下传给服务器的参数为：pageSize,pageNumber */
                queryParamsType: '',
                queryParams: function queryParams(params) {
                    var param = {
                        pageNumber: params.pageNumber,
                        pageSize: params.pageSize
                    };
                    for (var key in searchArgs) {
                        param[key] = searchArgs[key]
                    }
                    return param;
                },

                //【其它设置】
                locale: 'zh-CN',//中文支持
                pagination: true,//是否开启分页（*）
                pageNumber: 1,//初始化加载第一页，默认第一页
                pageSize: 5,//每页的记录行数（*）
                pageList: [5, 10, 20],//可供选择的每页的行数（*）
                sidePagination: "server", //分页方式：client客户端分页，server服务端分页（*）
                showRefresh: true,//刷新按钮
                clickToSelect: true,                //是否启用点击选中行
                singleSelect : true,
                showToggle:true,                    //是否显示详细视图和列表视图的切换按钮
                cardView: false,                    //是否显示详细视图
                detailView: false,                   //是否显示父子表
                sortable: true,                     //是否启用排序
                sortOrder: "asc",                   //排序方式
                uniqueId: "id",                     //每一行的唯一标识，一般为主键列

                //【样式设置】
                height: 300,//table的高度
                //按需求设置不同的样式：5个取值代表5中颜色['active', 'success', 'info', 'warning', 'danger'];


                //【设置列】
                columns: [
                    {checkbox: true},
                    //{field: 'id', title: 'id'},
                    {field: 'phone', title: '手机号'},
                    {field: 'accountType', title: '账户类型'},
                    {field: 'totalAmt', title: '总金额'},
                    {field: 'viableAmt', title: '可用金额'},
                    {field: 'freezedAmt', title: '冻结金额'},
                    {field: 'status', title: '状态'},
                    {field: 'createTime', title: '入库时间'},
                    {field: 'updateTime', title: '更新时间'},
                    {field: 'remark', title: '备注'}
                ]
            })
        }
    }


    var ButtonInit = function (bstpTable) {
        var oInit = new Object();
        var postdata = {};
        oInit.Init = function (bstpTable) {

            //查询
            $(".search").click(function () {
                var searchArgs = {
                    phone: $("input[name='phone']").val()
                };
                bstpTable.inint(searchArgs)
            });




            var userdata;
            //打开model窗口
            $("#btn_edit2").click(function() {
                var arrselections = $("#table_user").bootstrapTable('getSelections');
                userdata = arrselections[0];
                $("#id").val(userdata.id);
                $("#save_name").val(userdata.name);
                $("#save_sex").val(userdata.sex);

                $("#save_age").val(userdata.age);
                $("#save_phone").val(userdata.phone);

            });

            //保存
            $("#save").click(function() {
                var id = $("#id").val();
                var save_name = $("#save_name").val();
                var save_sex = $("#save_sex").val();
                var save_age = $("#save_age").val();
                var save_phone = $("#save_phone").val();
                if (id=="") {parent.layer.msg('未选择用户！');return false;}
                if (save_name =="" || save_age=="") {parent.layer.msg('姓名年龄不能留空！');return false;}
               /* $.get('{:url("Hplus/index/editpass")}','cid='+cid+'&amp;pass='+pass+'&amp;repass='+repass,function (msg) {
                    parent.layer.msg(msg);
                    $("#myModal").modal('hide');
                });*/
                $.ajax({
                    type: "post",
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    url: "/Home/save",
                    data: JSON.stringify(jsonSaveData()),
                    success: function (data, status) {
                        if (status == "success") {
                            layer.alert('更新数据成功');
                            $("#myModal").modal('hide');
                            $("#table_user").bootstrapTable('refresh');
                        }
                    },
                    error: function () {
                        alert('Error');
                    },
                    complete: function () {
                    }
                });

            });

            function jsonSaveData() {
                var json = {
                    "id": $("#id").val(),
                    "name": $("#save_name").val(),
                    "sex": $("#save_sex").val(),
                    "age": $("#save_age").val(),
                    "phone": $("#save_phone").val()
                };
                return json;
            }
        };
        return oInit;
    };

</script>

</body>

<!-- END BODY -->

</html>